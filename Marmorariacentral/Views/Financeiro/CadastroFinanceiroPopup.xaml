<?xml version="1.0" encoding="utf-8" ?>
<mct:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
           xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
           xmlns:mct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
           x:Class="Marmorariacentral.Views.Financeiro.CadastroFinanceiroPopup"
           Color="Transparent">

    <Border BackgroundColor="White"
            StrokeShape="RoundRectangle 20"
            Padding="20"
            WidthRequest="450"
            HeightRequest="550"
            VerticalOptions="Center">

        <Grid RowDefinitions="Auto, *, Auto" RowSpacing="10">

            <Label x:Name="LblTitulo" 
                   Grid.Row="0"
                   Text="Novo Lançamento"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="#8B1A1A"
                   HorizontalOptions="Center"
                   Margin="0,0,0,10"/>

            <ScrollView Grid.Row="1">
                <VerticalStackLayout Spacing="15">

                    <Entry x:Name="EntryDesc"
                           Placeholder="Descrição (Ex: Aluguel, Café)" />

                    <Grid ColumnDefinitions="*, *" ColumnSpacing="10">

                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="Valor (R$)" FontSize="12" TextColor="#666"/>
                            <Entry x:Name="EntryValor" Placeholder="0.00" Keyboard="Numeric"/>
                        </VerticalStackLayout>

                        <VerticalStackLayout x:Name="LayoutData" Grid.Column="1">
                            <Label Text="Data Vencimento" FontSize="12" TextColor="#666"/>

                            <DatePicker x:Name="PickerData" Format="dd/MM/yyyy">
                                <DatePicker.Triggers>
                                    <DataTrigger TargetType="DatePicker"
                                                 Binding="{Binding IsChecked, Source={x:Reference CheckMensal}}"
                                                 Value="True">
                                        <Setter Property="IsEnabled" Value="False"/>
                                        <Setter Property="Opacity" Value="0.5"/>
                                    </DataTrigger>
                                </DatePicker.Triggers>
                            </DatePicker>
                        </VerticalStackLayout>

                    </Grid>

                    <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                        <Label Text="Saída" VerticalOptions="Center" TextColor="Red"/>
                        <Switch x:Name="SwitchTipo" OnColor="Green" ThumbColor="White"/>
                        <Label Text="Entrada" VerticalOptions="Center" TextColor="Green"/>
                    </HorizontalStackLayout>

                    <VerticalStackLayout x:Name="LayoutOpcoesFinanceiras" Spacing="15">
                        
                        <HorizontalStackLayout Spacing="20" HorizontalOptions="Center">
                            <HorizontalStackLayout Spacing="5">
                                <CheckBox x:Name="CheckMensal" CheckedChanged="OnCheckMensalChanged"/>
                                <Label Text="Mensal (Fixo)" VerticalOptions="Center"/>
                            </HorizontalStackLayout>

                            <HorizontalStackLayout Spacing="5">
                                <CheckBox x:Name="CheckParcelado" CheckedChanged="OnCheckParceladoChanged"/>
                                <Label Text="Parcelado" VerticalOptions="Center"/>
                            </HorizontalStackLayout>
                        </HorizontalStackLayout>

                        <VerticalStackLayout Spacing="5"
                                             IsVisible="{Binding IsChecked, Source={x:Reference CheckMensal}}">
                            <Label Text="Dia de Vencimento Todo Mês"
                                   FontSize="12"
                                   TextColor="#8B1A1A"
                                   FontAttributes="Bold"/>
                            <Entry x:Name="EntryDiaFixo"
                                   Placeholder="Ex: 10"
                                   Keyboard="Numeric"
                                   MaxLength="2"/>
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="5"
                                             IsVisible="{Binding IsChecked, Source={x:Reference CheckParcelado}}">
                            <Label Text="Quantidade de Parcelas" FontSize="12" TextColor="#666"/>
                            <Entry x:Name="EntryParcelas"
                                   Placeholder="Ex: 12"
                                   Keyboard="Numeric"/>
                        </VerticalStackLayout>
                        
                    </VerticalStackLayout>

                </VerticalStackLayout>
            </ScrollView>

            <VerticalStackLayout Grid.Row="2" Spacing="5">
                <Button x:Name="BtnSalvar"
                        Text="LANÇAR NO FINANCEIRO"
                        BackgroundColor="#8B1A1A"
                        TextColor="White"
                        HeightRequest="50"
                        Clicked="OnSalvarClicked"/>
                <Button Text="Cancelar"
                        BackgroundColor="Transparent"
                        TextColor="#999"
                        Clicked="OnCancelarClicked"/>
            </VerticalStackLayout>

        </Grid>
    </Border>
</mct:Popup>